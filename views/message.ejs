<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>MINI MESSAGER BOARD</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <section class="message-section">
            <div class="message">
            <h3><%= message.user %></h3>
            <p><%= message.text %></p>
            <div class="bottom">
                <p class="date"><%= message.added_date %></p>
                <div class="link-btns">
                    <a class="close" href="/">Close</a>
                    <div class="modify-btns">
                        <button class="delete" data-id="<%=message.id%>">Delete</button>
                        <a class="edit" href="/edit/<%=message.id%>">Edit</a>                    </div>
                </div>
            </div>
        </section>
        
        </div>
        <script>
            async function changeRoute(id, method){
                try {
                    await fetch(`/delete/${id}`,  {
                        method:method
                    })
                }catch (err) {
                    throw err
                }
            }
            document.querySelector(".delete")
            .addEventListener("click", async (e)=>{
                console.log("clicked")
                const id = e.target.dataset.id;
                console.log(id)
                await changeRoute(id, "DELETE")
                window.location.href = "/";
            })
            
        </script>
    </body>
</html>
